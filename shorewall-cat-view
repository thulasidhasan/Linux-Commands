server@ubuntu:~$ ssh manager@192.168.0.1
manager@192.168.0.1's password: 
Welcome to Ubuntu 14.04.5 LTS (GNU/Linux 3.13.0-32-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

  System information as of Tue Feb 27 16:44:07 IST 2018

  System load:  0.0                Users logged in:     0
  Usage of /:   12.1% of 39.31GB   IP address for eth1: 192.168.0.1
  Memory usage: 5%                 IP address for eth0: 10.10.10.5
  Swap usage:   0%                 IP address for tun0: 10.8.0.1
  Processes:    88

  Graph this data and manage this system at:
    https://landscape.canonical.com/

Last login: Tue Feb 27 16:44:07 2018 from 192.168.1.195
manager@dhcp:~$ cd /etc/shorewall/
manager@dhcp:/etc/shorewall$ cat rules
#ACTION		SOURCE	DEST									PROTO		DEST PORT(S)

Ping/ACCEPT	loc	net
Ping/ACCEPT     net	$FW
Ping/ACCEPT     loc	$FW
Ping/ACCEPT     $FW	net

Web/ACCEPT     	net	$FW
Web/ACCEPT     	loc	$FW
Web/ACCEPT	loc	net
Web/ACCEPT	vpn	net

SSH/ACCEPT	net	$FW

SMTP/ACCEPT	loc	net
SMTP/ACCEPT	loc	net									tcp            smtp,587
IMAP/ACCEPT	loc	net
IMAP/ACCEPT	loc	net									tcp		993,465
POP3/ACCEPT	loc	net			
ACCEPT		loc	net									tcp		3389
ACCEPT 		loc 	net 									udp 		53
ACCEPT		loc 	net 									tcp 		53

ACCEPT		net 	$FW 									tcp 		ssh
#DNAT		net	loc:10.10.10.5								tcp		22

ACCEPT		loc	net:52.52.103.54,52.38.145.244,54.183.172.32				tcp		8080
#ACCEPT		loc	net:ec2-52-52-103.us-west-1.compute.amazonaws.com			tcp		8080

ACCEPT		loc	net:205.147.99.148,205.147.99.170					tcp		8085

ACCEPT		loc	net:13.76.83.224							tcp		81,82,8080,8085,27017,7568

ACCEPT          loc     net:birminghamstaging.crpxulwgtimd.us-west-2.rds.amazonaws.com          tcp             3306

#ACCEPT		loc	net:13.76.172.98							tcp		82,81

ACCEPT		net	$FW									udp		1194
ACCEPT		net	$FW									tcp		1194 

ACCEPT          loc     net:!64.85.238.249                                                      tcp             ssh
ACCEPT          wave    net:64.85.238.249                                                       tcp             ssh,https

ACCEPT		vpn	loc
ACCEPT		vpn	$FW		

ACCEPT		loc	net:113.193.25.106,61.12.92.250						tcp		4022,4066,7676
ACCEPT		loc	net:199.43.199.17,192.111.145.105					tcp

ACCEPT		loc	net:23.239.203.13							tcp

ACCEPT		loc	net:88.99.66.211							tcp		8080,80,8100	

ACCEPT		loc 	net:54.183.241.28,54.183.143.168					tcp 		8080,11962,1521,11960	

ACCEPT		loc	net:brm.cjo3vkpwzaaf.us-west-1.rds.amazonaws.com			tcp		1521

ACCEPT		loc 	net:88.99.93.168							tcp		47118

ACCEPT		loc	net:88.99.93.166							tcp		8080,7080,9080,8090,9070,7070

ACCEPT		loc	net:esakhi.netzary.com							tcp		8080,7568

ACCEPT		loc	net:35.165.231.226							tcp		80,8080,27017

DNAT		net	loc:192.168.1.25:80							tcp		8888
DNAT		net	loc:192.168.1.2:22							tcp		4444

ACCEPT 		loc	net:88.99.215.104							tcp 		8080,8090,9080,9090
ACCEPT		loc	net:88.99.215.101							tcp		47118

ACCEPT          loc     net:88.99.251.42							tcp             8088,8080,8180

ACCEPT          loc     net:139.59.74.236                                                       tcp             80,8080

ACCEPT          loc     net:54.153.82.119                                                       tcp             80,8080,27017,9080,9484

ACCEPT   	loc	net:88.99.66.211							tcp		2222,9080

ACCEPT 		loc	net:94.130.57.3           	                                        tcp		8080,27017,2222	

ACCEPT		loc	net:104.199.71.177							tcp		8080,27017,80

ACCEPT  	loc	net:52.10.21.122							tcp		8080,8090,27017,47017

ACCEPT		loc	net:88.99.173.31							tcp		8080,27017,8070,3306

ACCEPT		loc	net:23.239.12.111							tcp		8080,27017,81,82

ACCEPT		loc	net:88.99.251.42							tcp		9090,9070

ACCEPT		loc	net:88.99.215.104							tcp		8070

ACCEPT		loc	net:136.243.107.84							tcp		8080,8090,8070,9090

ACCEPT		loc	net:136.243.111.69							tcp		47118

ACCEPT 		loc 	net:54.193.6.8								tcp		8080,9080

ACCEPT		loc	net:178.63.49.207							tcp		8080,7070,7080,7090,8070

ACCEPT		loc	net:78.46.92.173							tcp		47118

ACCEPT		loc	net:52.8.12.168,34.205.154.96,54.174.27.137				tcp		8080,8180,8009

ACCEPT		loc	net:88.99.211.41,195.201.9.67						tcp		7070,9080,7080,8180

ACCEPT		loc	net:88.99.142.134							tcp		47118

ACCEPT		loc	net:78.46.92.173							tcp		27017

ACCEPT		loc:192.168.1.228	net							tcp		1:65531,8080	
ACCEPT		loc:192.168.1.228	net							udp		1:65531,8080	

# End of File

manager@dhcp:/etc/shorewall$ cat zones
#
# Shorewall version 4.0 - Sample Zones File for two-interface configuration.
# Copyright (C) 2006 by the Shorewall Team
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License, or (at your option) any later version.
#
# See the file README.txt for further details.
#------------------------------------------------------------------------------
# For information about entries in this file, type "man shorewall-zones"
#
# The manpage is also online at 
# http://shorewall.net/manpages/shorewall-zones.html
#
###############################################################################
#ZONE		TYPE	OPTIONS			IN			OUT
#					OPTIONS			OPTIONS
fw		firewall
net		ipv4
loc		ipv4
wave:loc	ipv4
vpn		ipv4

#LAST LINE - ADD YOUR ENTRIES ABOVE THIS ONE - DO NOT REMOVE
manager@dhcp:/etc/shorewall$ cat policy 
#
# Shorewall version 4.0 - Sample Policy File for two-interface configuration.
# Copyright (C) 2006 by the Shorewall Team
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License, or (at your option) any later version.
#
# See the file README.txt for further details.
#------------------------------------------------------------------------------
# For information about entries in this file, type "man shorewall-policy"
#
# The manpage is also online at 
# http://shorewall.net/manpages/shorewall-policy.html
#
###############################################################################
#SOURCE		DEST		POLICY		LOG LEVEL	LIMIT:BURST

#
# Note about policies and logging:
#	This file contains an explicit policy for every combination of
#	zones defined in this sample.  This is solely for the purpose of
#	providing more specific messages in the logs.  This is not
#	necessary for correct operation of the firewall, but greatly
#	assists in diagnosing problems. The policies below are logically
#	equivalent to:
#
#	loc	net		ACCEPT
#	net	all		DROP		info
#	all	all		REJECT		info
#
#	The Shorewall-perl compiler will generate the individual policies
#	below from the above general policies if you set 
#	EXPAND_POLICIES=Yes in shorewall.conf. 
#


#policies for sub-zone wave which is created under net 

wave		net		CONTINUE	info
wave		$FW		CONTINUE
wave		all		CONTINUE	info


#Policies for traffic originating from the local LAN (loc)
#
# If you want to force clients to access the Internet via a proxy server
# on your firewall, change the loc to net policy to REJECT info.

loc		net		REJECT		info
loc		$FW		ACCEPT
loc		vpn		ACCEPT
loc		all		REJECT		info

#
# Policies for traffic originating from the firewall ($FW)
#
# If you want open access to the Internet from your firewall, change the
# $FW to net policy to ACCEPT and remove the 'info' LOG LEVEL.
# This may be useful if you run a proxy server on the firewall.
$FW		net		ACCEPT
$FW		loc		ACCEPT
$FW		vpn		ACCEPT
$FW		all		REJECT		info

#
# Policies for traffic originating from the Internet zone (net)
#
net		$FW		DROP		info
net		loc		DROP		info
net 		vpn		DROP		info
net		all		DROP		info

vpn		loc		ACCEPT
vpn		$FW		ACCEPT
vpn		net		ACCEPT
vpn		all		DROP 		info


# THE FOLLOWING POLICY MUST BE LAST
all		all		REJECT		info

#LAST LINE -- ADD YOUR ENTRIES ABOVE THIS LINE -- DO NOT REMOVE
manager@dhcp:/etc/shorewall$ cat interfaces 
#
# Shorewall version 4.0 - Sample Interfaces File for two-interface configuration.
# Copyright (C) 2006 by the Shorewall Team
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License, or (at your option) any later version.
#
# See the file README.txt for further details.
#------------------------------------------------------------------------------
# For information about entries in this file, type "man shorewall-interfaces"
#
# The manpage is also online at 
# http://shorewall.net/manpages/shorewall-interfaces.html
#
###############################################################################
#ZONE		INTERFACE	BROADCAST	OPTIONS
net     	eth0            detect          dhcp,tcpflags,routefilter,nosmurfs,logmartians
-	    	eth1            detect          tcpflags,nosmurfs
vpn		tun0		

#LAST LINE -- ADD YOUR ENTRIES BEFORE THIS ONE -- DO NOT REMOVE
manager@dhcp:/etc/shorewall$ logout

